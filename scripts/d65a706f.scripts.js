"use strict";var App=angular.module("fullsailsitinApp",["ngCookies","ngResource","ngSanitize","ngRoute","firebase"]);App.config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/home.tpl",controller:"MainCtrl"}).when("/sitin",{templateUrl:"views/sitin.tpl",controller:"ClassCtrl"}).when("/dates/:acro",{templateUrl:"views/dates.tpl",controller:"DateCtrl"}).when("/attended",{templateUrl:"views/attended.tpl",controller:"DateCtrl"}).when("/404",{templateUrl:"views/404.tpl"}).otherwise({redirectTo:"404"})}]),App.run(["$firebaseSimpleLogin","$rootScope",function(a,b){var c=new Firebase("https://sitin.firebaseio.com");b.loginObject=a(c),b.classHash={WFP1:"Web Final Project 1",WIU:"Web Interface & Usability",RMO:"Rich Media Optimization",PWA1:"Programming Web Applications 1",WIA:"Web Interaction & Animation",MDD:"Mobile Device Deployment",PWA2:"Programming Web Applications 2",SSL:"Server Side Languages",DBS:"Database Structures",FWF:"Front End Web Frameworks"},b.emailHash={WFP1:"adam.gedney@gmail.com",WIU:"adam.gedney@gmail.com",RMO:"adam.gedney@gmail.com",PWA1:"adam.gedney@gmail.com",WIA:"adam.gedney@gmail.com",MDD:"adam.gedney@gmail.com",PWA2:"adam.gedney@gmail.com",SSL:"adam.gedney@gmail.com",DBS:"adam.gedney@gmail.com",FWF:"adam.gedney@gmail.com"}}]),angular.module("fullsailsitinApp").controller("MainCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("fullsailsitinApp").controller("ClassCtrl",["$scope","$cookies","$rootScope","$http","$location","GetSitins","SendNotice",function(a,b,c,d,e,f,g){c.loginObject.$getCurrentUser().then(function(a){a||e.path("/")}),void 0===c.currentUser&&(c.currentUser={name:b.name,avatar:b.avatar,email:b.email});var h=f;console.log(h);var i="http://127.0.0.1:8887/public/get-classes",j=[],k=[];a.classData={},d({method:"GET",url:i}).success(function(b){for(var d=0;d<b.length;d++)j.push(b[d].class),k.push(c.classHash[b[d].class]);a.classData.classAcronyms=j,a.classData.classNames=k}).error(function(a){console.log("get class names error",a)});var l=g;console.log(l)}]),angular.module("fullsailsitinApp").controller("DateCtrl",["$scope","$routeParams","$http","$rootScope","$cookies","$location","GetSitins","SendNotice",function(a,b,c,d,e,f,g,h){d.loginObject.$getCurrentUser().then(function(a){a||f.path("/")}),void 0===d.currentUser&&(d.currentUser={name:e.name,avatar:e.avatar,email:e.email});var i=g;console.log(i);var j="http://127.0.0.1:8887/public/get-dates?data="+b.acro;d.classDetails={},c({method:"GET",url:j}).success(function(a){d.classDetails=a,d.classDetails.name=b.acro,d.classDetails.fullName=d.classHash[b.acro]}).error(function(a,b,c){console.log("get class names error",a,b,c)});var k=h;console.log(k)}]),angular.module("fullsailsitinApp").controller("loginCtrl",["$scope","$rootScope","$window","$cookies","$location",function(a,b,c,d,e){function f(){var a=new Firebase("https://sitin.firebaseio.com/users/");a.on("child_added",function(c){console.log(c.val(),c.val().name,b.currentUser.name),c.val().name!==b.currentUser.name&&a.child(b.currentUser.id).set(b.currentUser)}),g()}function g(){d.name=b.currentUser.name,d.avatar=b.currentUser.avatar,d.email=b.currentUser.email}a.loginUser=function(){b.loginObject.$login("github").then(function(a){console.log(a),null!==a&&(e.path("/sitin"),b.currentUser={name:a.displayName,avatar:a.avatar_url,email:a.email,id:a.uid},f())},function(a){console.log(a,"user auth failed")})}}]),angular.module("fullsailsitinApp").controller("logoutCtrl",["$scope","$rootScope","$window","$cookies","$location",function(a,b,c,d,e){a.logoutUser=function(){function a(){d.name="",d.avatar="",d.email="",d.sitins=""}b.loginObject.$logout(),b.currentUser="",a(),e.path("/")}}]),angular.module("fullsailsitinApp").factory("GetSitins",["$rootScope",function(a){var b=new Firebase("https://sitin.firebaseio.com/attended/"),c=[];return b.on("child_added",function(b){b.val().user===a.currentUser.name&&(c.push(b.val()),a.currentUser.sitins=c.length,a.sitins=c)}),c.length}]),angular.module("fullsailsitinApp").factory("SendNotice",["$rootScope","$http",function(a,b){function c(){var b=new Firebase("https://sitin.firebaseio.com/attended/"),c={classDate:a.modal.start,"class":a.modal.name,user:a.currentUser.name},d=(new Date).getTime();b.child(d).set(c)}function d(c,d){var e="http://127.0.0.1:8887/public/get-next?class="+c+"&date="+d;b({method:"GET",url:e}).success(function(b){a.modal={instructor:b[0].instructor,name:c,day:b[0].day,start:b[0].start,again:"again"}}).error(function(a,b,c){console.log("get class names error",a,b,c)})}a.confirm=function(b,c,e){a.currentIndex=b,a.showConfirmation=!1,a.showModal=!0,"next"===b?d(c,e):a.modal={instructor:a.classDetails[b].instructor,name:a.classDetails.name,day:a.classDetails[b].day,start:a.classDetails[b].start,again:""}},a.cancel=function(){a.showModal=!1,a.showConfirmation=!1},a.sendNotice=function(){var d=a.emailHash[a.modal.name];a.showConfirmation=!0;var e="http://127.0.0.1:8887/public/send-email?className="+a.classDetails.fullName+"&day="+a.modal.day+"&date="+a.modal.start+"&instructor="+a.modal.instructor+"&instEmail="+d+"&userEmail="+a.currentUser.email+"&userName="+a.currentUser.name;b({method:"GET",url:e}).success(function(b,d,e){console.log("email sent success",b,d,e),a.showConfirmation=!0,c()}).error(function(a,b,c){console.log("email send error",a,b,c)})}}]),angular.module("fullsailsitinApp").factory("FireConn",["$firebase",function(a){return function(b){var c="https://sitin.firebaseio.com/"+b,d=new Firebase(c);return a(d)}}]);